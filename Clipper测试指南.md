# 🧪 Clipper剪藏功能测试指南

## 🎯 测试目标

验证Obsidian Web Clipper是否能正确提取文字内容和图片。

## 📋 测试准备

### 1. 确认插件状态
- ✅ Clipper插件已安装并启用
- ✅ 配置文件已更新
- ✅ vault路径正确设置
- ✅ 文件夹有写入权限

### 2. 测试网站清单
准备以下类型的网站进行测试：

#### 文章类网站
- [ ] 知乎文章页
- [ ] 掘金文章页
- [ ] Medium文章页
- [ ] 阮一峰的网络日志

#### 技术文档网站
- [ ] MDN文档页
- [ ] GitHub README
- [ ] 技术博客

#### 新闻资讯网站
- [ ] 新浪新闻
- [ ] 腾讯新闻
- [ ] 网易新闻

## 🔍 测试步骤

### 步骤1: 基础功能测试

#### 测试1: 简单文章页
1. 打开知乎文章页: https://zhuanlan.zhihu.com/p/xxx
2. 点击浏览器扩展的Clipper图标
3. 选择"完整文章"模式
4. 点击"保存"
5. 检查生成的文件:
   - 文字内容是否完整
   - 图片是否正确保存
   - 格式是否正确

#### 预期结果:
```
---
title: 文章标题
url: https://zhuanlan.zhihu.com/p/xxx
author: 作者名
created: 2026-01-16
tags: #知乎 #文章
---

## 文章摘要
[自动生成的摘要]

## 关键词
[提取的关键词]

## 主要内容
[完整的文章正文内容，包含文字和图片]

## 个人思考
[预留的个人笔记区域]
```

### 步骤2: 针对性测试

#### 测试2: 不同内容类型
**A. 纯文字文章**
- 网站选择: 阮一峰的网络日志
- 验证点: 纯文字是否完整提取

**B. 图文并茂文章**
- 网站选择: 掘金技术文章
- 验证点: 文字和图片都正确保存

**C. 代码文章**
- 网站选择: GitHub README或技术博客
- 验证点: 代码块是否正确格式化

**D. 表格文章**
- 网站选择: 包含表格的网页
- 验证点: 表格是否正确转换为Markdown表格

### 步骤3: 特殊情况测试

#### 测试3: 动态加载内容
1. 打开需要滚动加载的网页
2. 确保内容完全加载完成
3. 使用Clipper剪藏
4. 验证动态加载的内容是否被提取

#### 测试4: 长文章处理
1. 选择一篇长文章(5000+字)
2. 使用Clipper剪藏
3. 验证内容完整性
4. 检查文件大小是否合理

#### 测试5: 反爬虫网站
1. 打开有反爬虫机制的网站
2. 等待完全加载
3. 使用Clipper剪藏
4. 验证是否能正常提取内容

## 📊 测试记录表

### 基础功能测试

| 网站类型 | 网站地址 | 文字内容 | 图片保存 | 格式正确 | 备注 |
|----------|----------|----------|----------|----------|------|
| 知乎文章 | https://zhuanlan.zhihu.com/p/xxx | ✅/❌ | ✅/❌ | ✅/❌ | 测试内容提取 |
| 掘金文章 | https://juejin.cn/post/xxx | ✅/❌ | ✅/❌ | ✅/❌ | 测试图文混合 |
| MDN文档 | https://developer.mozilla.org/zh-CN/docs/xxx | ✅/❌ | ✅/❌ | ✅/❌ | 测试技术文档 |
| Medium | https://medium.com/@xxx/xxx | ✅/❌ | ✅/❌ | ✅/❌ | 测试英文内容 |

### 特殊情况测试

| 测试项目 | 测试描述 | 预期结果 | 实际结果 | 备注 |
|----------|----------|----------|----------|------|
| 动态内容 | 滚动加载的页面 | 完整提取 | ✅/❌ | 需要滚动到底部 |
| 长文章 | 5000+字文章 | 完整提取 | ✅/❌ | 检查文件大小 |
| 反爬虫 | 有保护的网站 | 正常提取 | ✅/❌ | 可能需要等待 |
| 代码块 | 包含代码的文章 | 代码格式正确 | ✅/❌ | 语法高亮 |

## 🔧 调试方法

### 1. 浏览器开发者工具

#### 步骤:
1. 打开目标网页
2. 右键 → "检查" 打开开发者工具
3. 切换到 "Console" 标签页
4. 粘贴以下代码测试选择器:

```javascript
// 测试内容选择器
const selectors = ['article', '.content', 'main', '.post-content', '.entry-content', '.article-body', '.main-content', '#content', '#main'];
let foundElement = null;

for (const selector of selectors) {
  const element = document.querySelector(selector);
  if (element) {
    console.log(`找到内容区域: ${selector}`);
    console.log(`内容长度: ${element.textContent.length}`);
    console.log('内容预览:', element.textContent.substring(0, 100));
    foundElement = element;
    break;
  }
}

if (!foundElement) {
  console.log('未找到任何内容选择器');
  console.log('页面body:', document.body.textContent.length);
}
```

#### 结果分析:
- ✅ 如果找到内容区域且长度>100，选择器正常
- ❌ 如果未找到，需要添加新的选择器

### 2. Clipper调试模式

启用调试模式查看详细日志:
```json
"debugMode": true,
"logLevel": "debug"
```

### 3. 手动验证

#### 检查生成的文件:
1. 在Obsidian中打开剪藏的文件
2. 检查YAML frontmatter是否正确
3. 检查正文内容是否完整
4. 检查图片是否正确显示

## 🚨 问题诊断

### 问题1: 只有图片没有文字

**可能原因**:
- 内容选择器不正确
- 网站结构特殊
- JavaScript渲染延迟

**解决方法**:
1. 使用浏览器测试选择器
2. 更新contentSelector配置
3. 增加等待时间

### 问题2: 内容不完整

**可能原因**:
- 移除选择器过度
- 内容被截断
- 特殊字符处理

**解决方法**:
1. 检查removeSelector配置
2. 调整maxContentLength
3. 检查字符编码

### 问题3: 格式混乱

**可能原因**:
- HTML转换问题
- 样式丢失
- 结构混乱

**解决方法**:
1. 检查cleanHtml设置
2. 禁用样式移除
3. 优化转换规则

## 📝 测试报告

### 基础测试结果
- [ ] 简单文章: ✅/❌
- [ ] 图文文章: ✅/❌
- [ ] 技术文档: ✅/❌
- [ ] 英文内容: ✅/❌

### 性能测试结果
- [ ] 大文件处理: ✅/❌
- [ ] 动态内容: ✅/❌
- [ ] 反爬虫网站: ✅/❌

### 问题记录
```
问题描述: ________________________
发生网站: ________________________
复现步骤: ________________________
解决方法: ________________________
```

## 🔄 优化建议

### 1. 根据测试结果优化配置

**如果发现特定网站有问题**:
```json
"customSelectors": {
  "problematic-site.com": {
    "contentSelector": ".specific-content-area",
    "removeSelector": ".unwanted-elements"
  }
}
```

**如果内容提取不完整**:
```json
"minContentLength": 50,
"maxContentLength": 100000,
"fallbackSelector": "body"
```

### 2. 建立测试流程

1. **每日测试**: 每天测试一个新网站
2. **每周检查**: 检查配置文件有效性
3. **每月优化**: 根据使用情况调整配置

### 3. 维护测试用例

- 保存成功的测试案例
- 记录配置修改历史
- 建立问题解决库

---

*Clipper测试指南 | 创建于 2026-01-16*